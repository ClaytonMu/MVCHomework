@model IEnumerable<MVCHomework1.Models.客戶資料>

@{
    ViewBag.Title = "Index";
}

@section Scripts {
    <script>
        $("#btnExport").on("click", function () {


            //$.ajax({
            //    url: "ExportToExcel",
            //    data: "",
            //    type: "Get",
            //    dataType: 'text',

            //    success: function (msg) {
            //        alert(msg);
            //    },


            //});
        })
    </script>
}

<h2>Index</h2>


    @Html.ActionLink("Create New", "Create")
    @Html.ActionLink("測試錯誤自訂", "TestError")
    @using (Html.BeginForm())
    {
        <p>
            Keyword: @Html.TextBox("keyword")
            <input type="submit" value="查詢" />
            @Html.Partial("_ExportToExcelPartial")
        </p>
    }
    

    <table class="table">
        <tr>
            <th>
                @Html.ActionLink("客戶名稱", "Index", new { sortOrder = "客戶名稱_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("統一編號", "Index", new { sortOrder = "統一編號_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("電話", "Index", new { sortOrder = "電話_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("傳真", "Index", new { sortOrder = "傳真_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("地址", "Index", new { sortOrder = "地址_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("Email", "Index", new { sortOrder = "Email_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th>
                @Html.ActionLink("客戶類別", "Index", new { sortOrder = "客戶類別_" + ViewBag.SortOrder, keyword = ViewBag.Keyword })
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.客戶名稱)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.統一編號)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.電話)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.傳真)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.地址)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Email)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.客戶類別)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            </tr>
        }

    </table>
